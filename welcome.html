<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Welcome — Logic Legend</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root{--bg1:#1e3c72;--bg2:#27ae60;--accent:#27ae60;--card-radius:16px;--shadow:0 14px 40px rgba(11,22,39,0.18)}
        html,body{height:100%;margin:0}
        body{font-family:'Inter',Arial,sans-serif;background:linear-gradient(135deg,var(--bg1),var(--bg2));display:flex;align-items:center;justify-content:center;padding:24px;color:#fff}

        .card{width:100%;max-width:640px;border-radius:var(--card-radius);padding:28px;background:rgba(6,11,20,0.45);backdrop-filter:blur(6px);box-shadow:var(--shadow);}
        .card h1{margin:0 0 8px;font-size:22px}
        .info{margin-top:12px;background:rgba(255,255,255,0.06);padding:14px;border-radius:10px}
        .row{display:flex;gap:18px;flex-wrap:wrap}
        .col{flex:1;min-width:180px}

        .btn{display:inline-block;margin-top:18px;padding:12px 18px;background:#fff;color:var(--accent);border-radius:10px;text-decoration:none;font-weight:700}
    </style>
</head>
<body>

    <div class="card" role="region" aria-label="Welcome card">
        <h1>Registration Complete</h1>
        <p class="small" style="color:rgba(255,255,255,0.85)">Thank you for registering with Logic Legend.</p>

        <div id="userInfo" class="info" aria-live="polite">Loading…</div>

        <div id="photoSection" style="margin-top:12px;display:none">
            <div style="font-weight:600;margin-bottom:8px;color:rgba(255,255,255,0.9)">Photo (optional)</div>
            <input id="photoInput" type="file" accept="image/*" />
            <div id="photoPreview" style="margin-top:10px"></div>
        </div>

        <div style="margin-top:14px;display:flex;gap:12px;flex-wrap:wrap">
            <a id="nextBtn" class="btn" href="#">Next: More Details</a>
            <a id="registerMore" class="btn" href="register.html">Register Another</a>
        </div>
    </div>

    <script>
        function getQueryParam(key) { return new URLSearchParams(window.location.search).get(key); }
        const userId = getQueryParam('userId');
        const userRaw = localStorage.getItem('user:' + userId);
        const user = userRaw ? JSON.parse(userRaw) : null;

        const infoDiv = document.getElementById('userInfo');
        const nextBtn = document.getElementById('nextBtn');

        if (user) {
            infoDiv.innerHTML = `
                <div class="row">
                    <div class="col"><strong>Name</strong><div>${user.name}</div></div>
                    <div class="col"><strong>Aadhar</strong><div>${user.aadhar}</div></div>
                    <div class="col"><strong>Phone</strong><div>${user.phone}</div></div>
                </div>
            `;
            nextBtn.href = 'details.html?userId=' + encodeURIComponent(user.id);

            // Photo section: show input and preview; save base64 image to user record
            const photoSection = document.getElementById('photoSection');
            const photoInput = document.getElementById('photoInput');
            const photoPreview = document.getElementById('photoPreview');
            photoSection.style.display = 'block';

            function showPhoto(dataUrl){
                photoPreview.innerHTML = `<img src="${dataUrl}" style="max-width:140px;border-radius:8px;border:1px solid rgba(255,255,255,0.1)" alt="photo"/>`;
            }

            if (user.photo) { showPhoto(user.photo); }

            photoInput.addEventListener('change', function(e){
                const f = e.target.files && e.target.files[0];
                if (!f) return;
                const reader = new FileReader();
                reader.onload = function(){
                    const data = reader.result;
                    showPhoto(data);
                    // update single user record
                    const key = 'user:' + user.id;
                    const u = JSON.parse(localStorage.getItem(key) || '{}');
                    u.photo = data;
                    localStorage.setItem(key, JSON.stringify(u));
                };
                reader.readAsDataURL(f);
            });

        } else {
            infoDiv.innerHTML = '<div>User not found. Redirecting to intro...</div>';
            nextBtn.style.display = 'none';
            // Redirect back to the intro/front page after a short delay
            setTimeout(() => { window.location.href = 'index.html'; }, 900);
        }
    </script>

</body>
</html>
